import{initializeApp as e}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";import{getAuth as t,GoogleAuthProvider as o,signInWithPopup as n,onAuthStateChanged as a,signOut as i,signInAnonymously as s}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";import{getFirestore as r,doc as c,getDoc as d}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";import{getAnalytics as w}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";const m=e({apiKey:"AIzaSyDuq7jYQcKDKY3UWNxQwP51fKRwjCERuvo",authDomain:"wakefield-central-mosque.firebaseapp.com",projectId:"wakefield-central-mosque",storageBucket:"wakefield-central-mosque.appspot.com",messagingSenderId:"998395111777",appId:"1:998395111777:web:5492302e7279822d5cbd20",measurementId:"G-NXER4ENDE0"}),l=t(m),f=r(m),h=(w(m),new o);window.firebaseAuth=l,window.firebaseDb=f;window.location.pathname.includes("/admin")&&a(l,(async e=>{if(e){await async function(e){if(!e)return!1;const t=c(f,"admins",e);return(await d(t)).exists()}(e.uid)||(alert("Access Denied. You are not an authorized admin."),await i(l),window.location.href="/login.html")}else window.location.href=`/login.html?redirect=${window.location.pathname}`})),window.location.pathname.includes("/login.html")&&document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("google-signin-btn");e&&e.addEventListener("click",(()=>{n(l,h).then((e=>{const t=new URLSearchParams(window.location.search).get("redirect");window.location.href=t||"/admin.html"})).catch((e=>{console.error("Google Sign-In Error:",e);const t=document.getElementById("login-error");t&&(t.textContent=e.message,t.classList.remove("d-none"))}))}))}));
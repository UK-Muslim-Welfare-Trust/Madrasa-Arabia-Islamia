import{initializeMessaging as r}from"./firebase-init.mjs";import{getToken as e}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-messaging.js";import{getFunctions as o,httpsCallable as s}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-functions.js";export async function subscribeToTopic(t,i){if(!i)return console.error("Service Worker not registered, cannot subscribe."),!1;const{messaging:n,messagingSupported:c}=await r();if(!c)return alert("Push notifications are not supported on this device."),!1;try{const r=await e(n,{vapidKey:"BCiOgp50gotHnfdiLjtx86mJZ-hGV94JWVuLjsiPsBd-CFAMpg8REdBZs6zb0Ofr5Lpo7Ezu50yAfEhgmcqIcMY",serviceWorkerRegistration:i});if(r){const e=o(),i=s(e,"manageSubscription");return await i({token:r,topic:t,action:"subscribe"}),console.log(`Request to subscribe to ${t} sent.`),!0}return!1}catch(r){return console.error(`Error subscribing to ${t}:`,r),alert("Could not subscribe to notifications. Please check console for details."),!1}}export async function unsubscribeFromTopic(t,i){if(!i)return void console.error("Service Worker not registered, cannot unsubscribe.");const{messaging:n}=await r(),c=await e(n,{serviceWorkerRegistration:i});if(c)try{const r=o(),e=s(r,"manageSubscription");await e({token:c,topic:t,action:"unsubscribe"}),console.log(`Request to unsubscribe from ${t} sent.`)}catch(r){console.error(`Error unsubscribing from ${t}:`,r)}}
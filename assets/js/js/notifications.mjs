import{initializeMessaging as t}from"./firebase-init.mjs";import{getToken as o}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-messaging.js";const s="https://us-central1-wakefield-central-mosque.cloudfunctions.net/manageSubscription";export async function subscribeToTopic(e,i){const{messaging:n,messagingSupported:r}=await t();if(!r)return alert("Push notifications are not supported on this device."),!1;try{const t=await o(n,{vapidKey:"BCiOgp50gotHnfdiLjtx86mJZ-hGV94JWVuLjsiPsBd-CFAMpg8REdBZs6zb0Ofr5Lpo7Ezu50yAfEhgmcqIcMY"});return t?(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,topic:e,action:"subscribe"})}),console.log(`Request to subscribe to ${e} sent successfully.`),!0):(console.error("Could not get FCM token."),!1)}catch(t){return console.error(`Error subscribing to ${e}:`,t),alert("Could not subscribe to notifications. The server might be busy. Please try again."),!1}}export async function unsubscribeFromTopic(e,i){const{messaging:n}=await t(),r=await o(n,{vapidKey:"BCiOgp50gotHnfdiLjtx86mJZ-hGV94JWVuLjsiPsBd-CFAMpg8REdBZs6zb0Ofr5Lpo7Ezu50yAfEhgmcqIcMY"});if(r)try{await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r,topic:e,action:"unsubscribe"})}),console.log(`Request to unsubscribe from ${e} sent.`)}catch(t){console.error(`Error unsubscribing from ${e}:`,t)}}
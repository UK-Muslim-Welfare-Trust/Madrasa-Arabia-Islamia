import{requestLocalNotificationPermission as e,scheduleJamaatNotifications as t,cancelJamaatNotifications as o,requestPushNotificationPermission as n}from"./notifications.mjs";const a=()=>{if("undefined"==typeof jQuery)return void console.error("jQuery is not loaded.");const e=jQuery;setTimeout((()=>{e("#spinner").removeClass("show")}),1),"undefined"!=typeof WOW&&(new WOW).init(),e(window).scroll((function(){e(this).scrollTop()>100?e(".back-to-top").fadeIn("slow"):e(".back-to-top").fadeOut("slow")})),e(".back-to-top").click((()=>(e("html, body").animate({scrollTop:0},1500,"easeInOutExpo"),!1)))};document.addEventListener("DOMContentLoaded",(()=>{if((()=>{const o=window.matchMedia("(display-mode: standalone)").matches,a=localStorage.getItem("notificationSetupComplete");if(o&&!a){console.log("First launch after install detected. Showing notification prompt.");const o=document.getElementById("notification-prompt-modal"),a=document.getElementById("enable-notifications-btn"),i=document.getElementById("subscribeAnnouncementsModal"),c=document.getElementById("subscribeJamaatModal");if(o&&a&&i&&c){const l=new bootstrap.Modal(o);l.show(),a.addEventListener("click",(async()=>{i.checked&&await n()&&(localStorage.setItem("announcementNotificationsEnabled","true"),console.log("Subscribed to announcements.")),c.checked&&await e()&&(localStorage.setItem("jamaatNotificationsEnabled","true"),t(),console.log("Subscribed to Jama'at reminders.")),localStorage.setItem("notificationSetupComplete","true"),l.hide(),alert("Notification settings saved!")}))}}})(),window.matchMedia("(display-mode: standalone)").matches){const a=document.getElementById("install-button");a&&(a.style.display="none"),(()=>{if(!window.location.pathname.includes("prayerTimetable.html"))return;const a=document.getElementById("notification-controls");a&&(a.style.display="block");const i=document.getElementById("jamaat-notifications-toggle");i&&("true"===localStorage.getItem("jamaatNotificationsEnabled")&&(i.checked=!0,"granted"===Notification.permission&&t()),i.addEventListener("change",(async()=>{i.checked?await e()?(localStorage.setItem("jamaatNotificationsEnabled","true"),t()):i.checked=!1:(localStorage.setItem("jamaatNotificationsEnabled","false"),o())})));const c=document.getElementById("announcement-notifications-toggle");c&&("true"===localStorage.getItem("announcementNotificationsEnabled")&&(c.checked=!0),c.addEventListener("change",(async()=>{c.checked?await n()?localStorage.setItem("announcementNotificationsEnabled","true"):c.checked=!1:localStorage.setItem("announcementNotificationsEnabled","false")})))})()}else{const e=document.getElementById("notification-controls");e&&(e.style.display="none")}a()}));